# 딥러닝을 위한 통계

## 1. 확률 개요

확률이란 특정한 사건이 일어날 가능성을 수로 표현한 것을 의미한다.  

가지고 있는 데이터를 토대로 기대값을 예측할 수 있다. 예를 들어, 1,000개의 메일 중에 700개가 스팸 메일, 300개가 정상 메일이였다. 그렇다면, 새로운 메일이 하나 도착했을 때 그것이 스팸 메일일 확률은 7/10이 될 수 있다.  

<br/>

### 경우의 수

다양한 문제 상황에서의 확률을 계산하기 위해서는 기본적으로 경우의 수를 계산하는 방법을 알아야 한다.  
경우의 수를 계산하는 방법으로는 __순열__ 과 __조합__ 이 있다.  
 - __순열__
    - 서로 다른 n개에서 r개를 중복 없이 봅아 특정한 순서로 나열하는 것
    - 순열의 수 공식(n=r): nPr = n!
    - 순열의 수 공식(n!=r): nPr = n! / (n-r)!
    - 딥러닝 모델을 학습할 때는 매번(epoch) 모델에 학습 데이터를 넣을 순서를 섞어서 학습을 진행한다. 이떄, 에폭이란 학습 데이터 세트에 포함된 모든 데이터가 한 번씩 모델을 통과한 횟수를 말한다.
```python
# 파이선을 이용하면 전체 순열을 간단히 계산할 수 있다.
from itertools import permutations

arr = ['A', 'B', 'C']
result = list(permutations(arr, 2))
print(result);
```
<br/>

 - __조합__
    - 서로 다른 n개에서 r개를 중복 없이 순서를 고려하지 않고 뽑는 것
    - 조합의 수 공식: nCr = n! / r!(n - r)! = nCn-r
    - 딥러닝 아키텍처 중에는 샴 네트워크가 있다. 두 개의 이미지를 받아서, 두 이미지가 유사하다면 1을, 다르다면 0을 출력한다. 이때, N개의 이미지로 구성된 데이터 세트가 있을 때, 매번 2개의 이미지를 뽑아서 2개의 이미지를 네트워크의 입력으로 넣는다. 이 경우, 두 이미지에 대하여 순서는 상관없다.
    - 전체 이미지를 {1,2,3,4} 라고 했을 떄, 가능한 모든 경우는 [1,2], [1,3], [1,4], [2,3], [2,4], [3,4] 6가지가 된다. (4 * 3 / 2)
```python
# 파이썬을 이용하면 전체 조합을 간단히 계산할 수 있다.
from itertools import combinations

arr = ['A', 'B', 'C']
result = list(combinations(arr, 2))
print(result);
```
<br/>

 - __중복 순열__
    - 서로 다른 n개에서 중복을 포함해 r개를 뽑아 특정한 순서로 나열하는 것
    - 중복 순열의 수 공식: n∏r = n^r
```python
# 파이썬을 이용하면 전체 중복 순열을 간단히 계산할 수 있다.
from itertools import product

arr = ['A', 'B', 'C']
result = list(product(arr, repeat=2))
print(result)
```
<br/>

 - __중복 조합__
    - 서로 다른 n개에서 중복을 포함해 순서를 고려하지 않고 r개를 뽑는 것
    - 중복 조합의 수 공식: nHr = n+r-1Cr
    - 딥러닝에서는 학습된 여러 모델의 결과를 활용하여 최종적인 결과를 생성하는 앙상블 방법이 존재한다.
```python
# 파이썬을 이용하면 전체 중복 조합을 간단히 계산할 수 있다.
from itertools import combinations_with_replacement

arr = ['A', 'B', 'C']
result = list(combinations_with_replacement(arr, repeat=2))
print(result)
```
<br/>

### 확률

S를 전체 사건의 집합이라고 하고, 사건 X가 일어날 확률은 P(X)라고 가정한다.  
P(X)는 사건 X가 일어나는 경우의 수에서 전체 경우의 수를 나눈 값이 된다. [n(X) / n(S)]  
 - 통계적 확률
    - 시행을 반복함으로서 실제 확률과 근접한 결과가 나오게 된다.
    - 동일한 시행을 N번 반복해 사건 X가 발행한 횟수를 R이라고 할 떄, 시행 횟수 N을 무한히 크게 만들면 R/N이 수렴하는 값을 사건 X의 통계적 확률이라 한다.

